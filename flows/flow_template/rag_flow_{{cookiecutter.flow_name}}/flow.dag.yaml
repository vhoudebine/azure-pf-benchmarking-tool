inputs:
  question:
    type: string
    default: what is the capital of France
  llm_connection:
    type: string
    default: {{ cookiecutter.llm.connection }}
outputs:
  response:
    type: string
    reference: ${llm_node.output}
  context:
    type: string
    reference: ${vector_search_node.output}
environment:
  python_requirements_txt: requirements.txt
nodes: 
- name: vector_search_node
  type: python
  source:
    type: code
    path: ai_search.py
  inputs:
    search_conn: {{cookiecutter.vector_search.vector_store.connection}}
    openai_conn: {{cookiecutter.vector_search.embedding.connection}}
    question: ${inputs.question}
    search_index_name: {{cookiecutter.vector_search.vector_store.index}}
    embedding_deployment: {{cookiecutter.vector_search.embedding.deployment}}
  use_variants: false
{% if cookiecutter.llm.family == 'AZUREOPENAI' %}
- name: llm_node
  type: llm
  source:
    type: code
    path: llm_node.jinja2
  inputs:
    deployment_name: {{ cookiecutter.llm.deployment }}
    response_format:
      type: text
    max_tokens: 300
    question: ${inputs.question}
    context: ${vector_search_node.output}
  connection: {{ cookiecutter.llm.connection }}
  api: chat
{% else %}
{% if cookiecutter.llm.family == 'LLAMA' or cookiecutter.llm.family == 'MISTRAL' or cookiecutter.llm.family=='COHERE' %}
- name: llm_node
  type: python
  source:
    type: code
    path: maas_llm.py
  inputs:
    conn: {{cookiecutter.llm.connection}}
    question: ${inputs.question}
    context: ${vector_search_node.output}
  use_variants: false
{% else %}
{% endif %}
{% endif %}